# 데이터베이스 기말고사 정리

복습: No
작성일시: 2022년 12월 14일 오후 7:53

## Chapter 4 SQL 고급

### 03. 뷰(view)

- 뷰 : 하나 이상의 테이블을 합하여 만든 가상의 테이블
- 뷰의 장점
    - 편리성 및 재사용성 :  자주 사용되는 복잡한 질의를 뷰로 정의할 수 있음.
    - 보안성 : 사용자 별로 필요한 데이터를 선별해서 보여줄 수 있고 중요한 내용일 경우 암호화할 수 있음.
    - 독립성 : 일반 테이블처럼 사용할 수 있기 때문에 편리하고, 사용자가 필요한 정보만 요구에 맞게 설정하여 뷰로 만들 수 있음.
- 뷰의 특징
    - 원본 데이터 값에 따라 같이 변함
    - 독립적인 인덱스 생성이 어려움.
    - 삽입, 삭제, 갱신 연산에 많은 제약이 따른다.

### 뷰의 생성

- 기본 문법

Create View 뷰이름 [(열이름[….])]

As Select 문

- Book 테이블에서 ‘축구’라는 문구가 포함된 자료만 보여주는 뷰

Create View Vw_Book

As Select *

From Book

Where bookname Like ‘%축구%’

![Untitled](%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%86%E1%85%A1%E1%86%AF%E1%84%80%E1%85%A9%E1%84%89%E1%85%A1%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%20b784c85973d84099a98f576e7694dc99/Untitled.png)

### 뷰의 수정

- 기본 문법

Create of Replace view 뷰이름[(열이름[..])]
As Select  문

![Untitled](%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%86%E1%85%A1%E1%86%AF%E1%84%80%E1%85%A9%E1%84%89%E1%85%A1%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%20b784c85973d84099a98f576e7694dc99/Untitled%201.png)

### 뷰의 삭제

- 기본 문법

Drop view 뷰이름[..n]

![Untitled](%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%86%E1%85%A1%E1%86%AF%E1%84%80%E1%85%A9%E1%84%89%E1%85%A1%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%20b784c85973d84099a98f576e7694dc99/Untitled%202.png)

### 연습문제

![Untitled](%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%86%E1%85%A1%E1%86%AF%E1%84%80%E1%85%A9%E1%84%89%E1%85%A1%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%20b784c85973d84099a98f576e7694dc99/Untitled%203.png)

1. Create view highorders
As Select B.bookid, B.bookname, C.name, B.publisher, B.price
From Book B, Customer C
Where B.price >= 20000;
2. Select bookname, name
From highorders;
3. Alter table highorder drop price

## Chapter 6 데이터 모델링

### 01. 데이터 모델링의 개념

1. 데이터베이스 생명주기
- 데이터 모델링 : 현실 세계의 복잡한 개념을 단순화하고 추상화시켜 데이터베이스화하는 과정이다.
- 데이터베이스 생명주기 : 데이터베이스의 생성과 운영에 관련된 특징
    1. 요구 사항 수집 및 분석 : 사용자들의 요구사항을 듣고 구축 범위를 정함
    2. 설계 : 요구사항을 토대로 주요 개념과 프로세스 등을 식별하고, DBMS 종류에 맞게 변환한 후, 데이터 베이스 스키마를 도출함.
    3. 구현 : 스키마를 실제 DBMS에 적용하여 테이블 및 객체를 만듬
    4. 운영 : 구현된 데이터베이스를 기반으로 소프트웨어를 구축하여 서비스 제공
    5. 감시 및 개선 : 문제를 관찰하고 문제점을 파악해서 개선함.

- 개념적 모델링
    - 요구사항을 수집하고 분석한 결과를 토대로 업무의 핵심적인 개념을 구분하고 전체적인 뼈대를 만드는 과정
    - 개체를 추출하고 각 개체들 간의 관계를 정의하여 ER다이어그램을 만드는 과정
- 논리적 모델링
    - 개념적 모델링에서 만든 ER다이어그램을 사용하여 DBMS에 맞게 매핑하여 실제 데이터베이스로 구현하기 위한 모델을 만드는 과정
- 물리적 모델링
    - 작성된 논리적 모델을 저장장치에 저장하기 위한 물리적 구조를 정의하고 구현하는 과정

### 02. ER모델

- ER 모델 : 세상의 사물을 개체와 개체 간의 관계로 표현함
- 개체 : 독립적인 의미를 지니고 있는 사람또는 사물
- 속성 : 개체가 가진 성질
- 관계 : 개체 사이의 연관성을 나타내는 개념

ER다이어그램 그리고 논리적 설계해보기

### 03. ER 모델을 관계 데이터 모델로 사상

ER모델을 이용하여 실제 데이터베이스를 구축하기 위해서는 논리적 모델링 단계를 거치는데 이것을 mapping이라고 한다.

- 개체 타입 사상, 관계 타입 사상, 다중값 속성의 사상 사용해서 논리적 모델링 해보기.
- page 371 마당대학 데이터베이스 모델링 실습 참고.

## Chapter 07 정규화

### 01. 이상현상

- 이상현상에는 3가지 이상현상이 존재한다.
    - 삭제 이상이란 투플 삭제 시 다른 정보까지 삭제되는 연쇄삭제 현상을 말한다.
    - 삽입 이상이란 투플 삽입 시 해당 값이 없어 NULL값이 입력되는 현상을 말한다.
    - 수정 이상이란 투플 수정 시 중복된 데이터의 일부만 수정되어 데이터가 불일치되는 현상을 말한다.
- 연습문제로 이상현상 해결하기.

### 02. 함수 종속성

- 정규화 : 이상현상이 발생하는 테이블을 수정하여 정상으로 만드는 과정.
- 종속성 : 어떤 속성 A의 값을 알면 다른 속성 B의 값이 유일하게 정해지는 의존 관계를 ‘속성 B는 속성 A에 종속한다’ 혹은 ‘속성 A는 속성 B를 결정한다’ 라고 한다.

- 함수 종속성 다이어그램 표기법

![Untitled](%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%86%E1%85%A1%E1%86%AF%E1%84%80%E1%85%A9%E1%84%89%E1%85%A1%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%20b784c85973d84099a98f576e7694dc99/Untitled%204.png)

- 함수 종속성과 기본키
    - 릴레이션의 함수 종속성을 파악하기 위해서는 기본키를 찾아야한다.
    - 기본키가 함수 종속성에서 어떤 역할을 하는지 알면 이상현상을 제거하는 정규화 과정을 쉽게 이해할 수 있다.
    
    ![Untitled](%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%86%E1%85%A1%E1%86%AF%E1%84%80%E1%85%A9%E1%84%89%E1%85%A1%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%20b784c85973d84099a98f576e7694dc99/Untitled%205.png)
    
- 이상현상과 결정자.
    - 이상현상은 한개의 릴레이션에 두 개 이상의 정보가 포함되어 있을 때 나타남, 기본키가 아니면서 결정자인 속성이 있을 때 발생함.
    - 학생수강성적 릴레이션의 경우 학생 정보와 강좌정보가 한 릴레이션에 포함되어서 이상현상이 나타남.
    - 이러한 경우 이상현상을 없애려면 릴레이션을 분해해야한다.

### 03. 정규화

- 이상현상이 발생하는 릴레이션을 분해하여 이상현상을 없애는 과정
- 이상현상이 있는 릴레이션은 이상현상을 일으키는 함수 종속성의 유형에 따라 등급을 구분 가능
- 릴레이션은 정규형 개념으로 구분하며, 정규형이 높을수록 이상현상은 줄어듦.

- 제 1정규형

릴레이션 R의 모든 속성 값이 원자값을 가지면 제 1정규형이라고 함. ⇒ 하나의 원자값을 가질 때 제 1규형이라고 함.

![Untitled](%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%86%E1%85%A1%E1%86%AF%E1%84%80%E1%85%A9%E1%84%89%E1%85%A1%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%20b784c85973d84099a98f576e7694dc99/Untitled%206.png)

- 제 2정규형

릴레이션 R이 제 1정규형이고 기본키가 아닌 속성이 기본키에 완전 함수 종속일 대 제 2정규형이라고 함. ⇒ 기본키가 하나일 때 제 2정규형이라고 함.

![Untitled](%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%86%E1%85%A1%E1%86%AF%E1%84%80%E1%85%A9%E1%84%89%E1%85%A1%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%20b784c85973d84099a98f576e7694dc99/Untitled%207.png)

>> 제 2정규형의 이상현상을 해결하는 방법은 기본키로 포함된 속성들을 두개의 테이블로 분해하는 것이다.

- 제 3정규형

릴레이션 R이 제 2정규형이고 기본키가 아닌 속성이 기본키에 비이행적으로 종속할 때 제 3정규형이라고 함. ⇒ 기본키가 하나이고 비이행적으로 종속할 때 제 3정규형이라고 함.

![Untitled](%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%86%E1%85%A1%E1%86%AF%E1%84%80%E1%85%A9%E1%84%89%E1%85%A1%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%20b784c85973d84099a98f576e7694dc99/Untitled%208.png)

>> 제 3정규형을 해결하기 위해서는 테이블을 분해해야한다.

- BCNF

![Untitled](%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%86%E1%85%A1%E1%86%AF%E1%84%80%E1%85%A9%E1%84%89%E1%85%A1%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%20b784c85973d84099a98f576e7694dc99/Untitled%209.png)

![Untitled](%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%86%E1%85%A1%E1%86%AF%E1%84%80%E1%85%A9%E1%84%89%E1%85%A1%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%20b784c85973d84099a98f576e7694dc99/Untitled%2010.png)

- 부동산 데이터 베이스 정규화 실습해보기 > page.425

### Chapter 08 트랙잭션, 동시성 제어, 회복

01 트랜잭션

- 트랜잭션 : DBMS에서 데이터를 다루는 논리적인 작업의 단위
    - 데이터베이스에서 트랜잭션을 정의하는 이유
        - DB에서 데이터를 다룰 때 장애가 일어날 때 데이터를 복구하는 작업의 단위가 됨
        - DB에서 여러 작업이 동시에 같은 데이터를 다룰 때가 이 작업을 서로 분리하는 단위가 됨.
    - 트랜잭션은 전체가 수행되거나 또는 전혀 수행되지 않아야 함.
    - 
- 트랜잭션의 ACID 성질
    - 원자성 : 트랜잭션에 포함된 작업은 전부 수행되거나 아니면 전부 수행되지 않아함.
    - 일관성 : 트랜잭션을 수행하기 전이나 수행한 후나 데이터베이스는 항상 일관된 상태를 유지해야함.
    - 고립성 : 수행 중인 트랜잭션에 다른 트랜잭션이 끼어들어 변경 중인 데이터 값을 훼손하는 일이 없어한다.
    - 지속성 : 수행을 성공적으로 완료한 트랜잭션은 변경한 데이터를 영구히 저장해야 한다.
    
    ![Untitled](%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%86%E1%85%A1%E1%86%AF%E1%84%80%E1%85%A9%E1%84%89%E1%85%A1%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%20b784c85973d84099a98f576e7694dc99/Untitled%2011.png)
    

02 동시성 제어

- 동시성 제어 : 트랜잭션이 동시에 수행될 때, 일관성을 해치지 않도록 트랜잭션의 데이터 접근을 제어하는 DBMS기능

- 갱신손실 : 두 개의 트랜잭션이 한 개의 데이터를 동시에 갱신할 때 발생하며, 데이터베이스에서 절대 발생하면 안되는 현상.

- 락 : 갱신손실 문제를 해결하기 위해 상대방 트랜잭션이 데이터를 사용하는지 여부를 알 수 있는 규칙, 데이터를 수정 중이라는 사실을 알리는 방법의 잠금 장치

- 2단계 락킹 기법
    - 2단계 락킹이란 트랜잭션이 락을 걸고 해제하는 시점을 확장 단계와 수축 단게로 나누어 진행하는 것이다. 확장 단계는 트랜잭션이 필요한 락을 획득하는 단계로, 이 단계에서는 이미 획득한 락을 해제하지 않는다. 수축단계는 트랙잭션이 락을 해제하는 단계로, 이 단계에서는 새로운 락을 획득하지 않는다.
    - 락을 걸고 해제하는 시점에 제한을 두는 2단계 락킹기법을 사용하지 않으면 두 개의 트랜잭션이 동시에 실행될 때 데이터의 일관성이 깨질 수 있다.

04 회복

- 회복 : 데이터베이스에 장애가 발생했을 때 데이터베이스를 일관성 있는 상태로 돌리는 DBMS의 기능
- 데이터베이스 시스템에서 발생할 수 있는 장애 유형
    - 시스템 충돌 : 하드웨어 혹은 소프트웨어의 오류로 인하여 주기억장치가 손실되는 것을 말함.
    - 미디어 장애 :  읽기 장애에 의하여 보조기억장치의 일부 데이터가 손실되는 것을 말함.
    - 응용 소프트웨어 오류 : 데이터베이스에 접근하는 소프트웨어의 논리적인 오류로 트랜잭션 수행이 실패하는 것을 말함.
    - 자연 재해 : 자연재해로 인해 컴퓨터 시스템이 손상되는 것을 말한다.
    - 부주의 혹은 태업 : 운영자나 사용자의 부주의로 데이터가 손실되거나 의도적인 손상을 입는 것을 말한다.
    - 이 중에서 데이터베이스 시스템에서 회복에 중점을 두는 유형은 시스템 충돌, 미디어 장애, 응용 소프트웨어 오류이다.
    
- 로그 파일 : 트랜잭션이 반영한 모든 데이터의 변경 사항을 데이터베이스에 기록하기 전에 미리 기록해두는 별도의 데이터베이스

- 트랜잭션
    - 변경한 내용(버퍼)를 로그에 기록한 후 DB에 반영
    - DBMS의 회복 관리자는 트랜잭션의 ACID 성질 중 원자성과 지속성을 보장하여 장애로부터 데이터베이스를 보호함.
    - 장애가 발생하면 로그의 내용을 참조하여 트랜잭션의 변경 내용을 모두 반영하거나 아니면 아예 반영하지 않는다.
    - 트랜잭션의 순서(시작 - 수행 - 부분완료 - 완료)

- 로그 파일을 이용한 회복
    - 시스템 운영 중 장애가 발생하여 시스템이 다시 가동되었을 때 DBMS가 로그파일을 참고한 후 종료된 트랜잭션은 종료를 확인하기 위해 REDO을 진행하고 중돤된 트랜잭션 없던 일로 되돌리기 위해 취소를 진행한다.

- 즉시 갱신 방법: 즉시 갱신은 ‘갱신 데이터 → 로그’, ‘버퍼 → 데이터베이스’ 작업이 부분완료 전에 동시에 진행될 수 있으며, 부분완료 전에 버퍼의 갱신 데이터는 로그에 기록이 진행된 상태이며 부분완료 전에 버퍼의 일부 내용이 실제 데이터베이스에 반영될 수 있다.
- 지연 갱신 방법 : ‘갱신 데이터 → 로그’가 끝난 후 부분완료를 하고 ‘버퍼 → 데이터베이스’ 작업이 진행되는 방법.
- 지연 갱신은 즉시 갱신과 동일하게 부분완료가 되면 최소한 버퍼의 갱신 데이터는 로그에 모두 기록이 끝난 상태이지만, 데이터베이스에 반영되지 않은 상태이다. 지연 갱신을 사용하면 데이터베이스에 반영하는 작업은 지연되지만, 장애가 발생할 때 로그에 Start만 나타나는 트랜잭션은 취소 작업을 할 필요가 없는 장점이 있다.

- 체크포인트를 이용한 회복 : 로그를 이용한 회복은 시스템에 장애가 일어났을 때 어느 시점까지 되돌아가야 하는지 알 수 없는 문제점이 있다. 이러한 문제를 보완한 것이 체크 포인트를 이용한 회복이다. 체크포인트를 이용한 회복은 시간단위로 데이터베이스와 트랜잭션 로그 파일을 동기화 한 후 동기화한 시점을 로그 파일에 기록해두는 방법이다.

## Chapter 09 데이터베이스 보안과 관리

### 01. 데이터베이스 관리의 개요

- 데이터베이스는 하드웨어, 소프트웨어, 네트워크 등이 복합적으로 연결되어 운영된다. 만약 이 중에서 하나라도 문제가 생기면 서비스는 중지되거나 차질이 생긴다.
- DBA : 데이터베이스를 관리하는 사람. 데이터베이스 구축부터 운영까지 데이터베이스 시스템의 이상 유무를 점검하고 유지 보수를 하여 데이터베이스를 안정적으로 관리한다.
    - 서비스관리
    - 점검 및 모니터링
    - 장애 대처
    - 백업과 복원
    - 사용자 관리 및 권한 관리
    - 시스템 데이터베이스 관리
    - 사용자 데이터베이스 관리
    - 데이터베이스 저장 공간 관리
    - 인덱스 관리

### 02. 보안과 권한

- DBMS는 1 로그인 단계에서 DBMS접근을 제한하는 로그인 사용자 관리와 2 로그인한 사용자별로 특정 데이터로의 접근을 제한하는 권한 관리의 기능을 제공한다.

- 사용자 계정 생성

Create User [사용자이름] Idenetified by [비밀번호];

- 사용자 계정 삭제

Drop User [사용자이름] Cascade

- 권한 관리
    - 소유한 개체에 대한 사용 권한을 관리하기 위한 명령을 DCL이라고 함.

![Untitled](%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%86%E1%85%A1%E1%86%AF%E1%84%80%E1%85%A9%E1%84%89%E1%85%A1%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%20b784c85973d84099a98f576e7694dc99/Untitled%2012.png)

![Untitled](%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%86%E1%85%A1%E1%86%AF%E1%84%80%E1%85%A9%E1%84%89%E1%85%A1%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%20b784c85973d84099a98f576e7694dc99/Untitled%2013.png)

![Untitled](%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%86%E1%85%A1%E1%86%AF%E1%84%80%E1%85%A9%E1%84%89%E1%85%A1%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%20b784c85973d84099a98f576e7694dc99/Untitled%2014.png)